{
  "version": "2.0.0",
  "description": "CTO-protected MCP actions configuration. Protected actions require CTO or deputy-CTO approval before execution. Unknown MCP servers are blocked by default (Fix 3: server allowlist).",
  "servers": {},
  "allowedUnprotectedServers": [
    "setup-helper",
    "agent-tracker",
    "todo-db",
    "specs-browser",
    "session-events",
    "review-queue",
    "agent-reports",
    "cto-report",
    "cto-reports",
    "elastic-logs",
    "claude-sessions",
    "codecov",
    "chrome-bridge",
    "show",
    "product-manager",
    "user-feedback",
    "feedback-explorer",
    "playwright-feedback",
    "programmatic-feedback",
    "feedback-reporter",
    "playwright"
  ],
  "settings": {
    "codeLength": 6,
    "expiryMinutes": 5,
    "notifyOnBlock": true
  },
  "_examples": {
    "supabase": {
      "protection": "credential-isolated",
      "phrase": "APPROVE DATABASE",
      "tools": ["executeSql", "deleteData", "deleteUser", "deleteFile"],
      "credentialKeys": ["SUPABASE_SERVICE_ROLE_KEY", "SUPABASE_URL", "SUPABASE_ANON_KEY", "SUPABASE_ACCESS_TOKEN"],
      "description": "Supabase with branch-aware protection (G024)",
      "environments": {
        "production": {
          "branchPattern": "main",
          "requireApproval": true,
          "description": "Production (main branch) - destructive operations require CTO approval"
        },
        "staging": {
          "branchPattern": "staging",
          "requireApproval": false,
          "description": "Staging branch - destructive operations allowed without approval"
        },
        "preview": {
          "branchPattern": "preview/*",
          "requireApproval": false,
          "description": "Preview branches - ephemeral, no approval needed"
        }
      }
    },
    "vercel": {
      "protection": "deputy-cto-approval",
      "phrase": "APPROVE DEPLOY",
      "tools": ["vercel_promote_deployment", "vercel_rollback", "vercel_create_env_var", "vercel_delete_env_var"],
      "credentialKeys": ["VERCEL_TOKEN"],
      "description": "Deployment ops - deputy-cto can approve non-production, CTO required for production"
    },
    "stripe": {
      "protection": "credential-isolated",
      "phrase": "APPROVE PAYMENT",
      "tools": ["create_charge", "create_refund", "delete_customer"],
      "credentialKeys": ["STRIPE_SECRET_KEY"],
      "description": "Stripe - only destructive/financial tools require CTO approval"
    },
    "sendgrid": {
      "protection": "approval-only",
      "phrase": "APPROVE EMAIL",
      "tools": ["send_email", "send_bulk"],
      "description": "SendGrid - CTO approval required but credentials not isolated"
    },
    "onepassword": {
      "protection": "credential-isolated",
      "phrase": "APPROVE VAULT",
      "tools": ["create_service_account", "read_secret"],
      "credentialKeys": ["OP_SERVICE_ACCOUNT_TOKEN", "OP_CONNECT_TOKEN"],
      "description": "1Password vault — secret reading and admin operations require CTO approval"
    },
    "secret-sync": {
      "protection": "credential-isolated",
      "phrase": "APPROVE SYNC",
      "tools": ["secret_sync_secrets"],
      "credentialKeys": ["OP_SERVICE_ACCOUNT_TOKEN", "RENDER_API_KEY", "VERCEL_TOKEN"],
      "description": "Secret syncing — reads from 1Password and pushes to Render/Vercel"
    }
  },
  "_allowedUnprotectedServers_note": "Framework/internal MCP servers that don't need protection. Any server NOT in 'servers' and NOT in this list will be BLOCKED.",
  "_schema": {
    "servers": {
      "<server-name>": {
        "protection": "credential-isolated | approval-only | deputy-cto-approval",
        "phrase": "APPROVE <WORD>",
        "tools": "* | [list of tool names]",
        "credentialKeys": ["ENV_VAR_NAMES_TO_ENCRYPT"],
        "description": "Human-readable description",
        "environments": {
          "<env-name>": {
            "branchPattern": "Branch glob pattern (e.g., 'main', 'staging', 'preview/*')",
            "requireApproval": "Boolean: whether CTO approval is required for this environment",
            "description": "Human-readable description of this environment"
          }
        }
      }
    },
    "allowedUnprotectedServers": ["List of MCP server names that are allowed without protection (e.g., framework servers like agent-tracker, todo-db)"],
    "settings": {
      "codeLength": "Number of characters in approval code (default: 6)",
      "expiryMinutes": "How long approval codes are valid (default: 5)",
      "notifyOnBlock": "Show notification when action is blocked (default: true)"
    },
    "_protection_modes": {
      "credential-isolated": "CTO approval required. Credentials stored in .mcp.json, not in shell env.",
      "approval-only": "CTO approval required. No credential isolation.",
      "deputy-cto-approval": "Deputy-CTO AI agent can approve, deny, or escalate to CTO. Less secure but lower friction."
    }
  }
}
